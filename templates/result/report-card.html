{% extends 'management/base.html' %}
{% load static %}
{% block custom_css %}
{% endblock custom_css %}
{% block content %}
  {% for key,result in results.items %}
    <div class="card">
      <div class="card-header">
        <div style="display: flex; align-items: center; justify-content: space-between;">
          {% if school_logo.url %}
          <img src="{{school_logo.url}}" alt="Your image" class="passport-image" style="border: 1px solid black; float: left;">
          {% else %}
            <img src="{% static 'school_logo/default.png' %}" alt="Your image" class="passport-image" style="border: 2px solid black; float: left;">
            {% endif %}
          <div class="card-text" style="margin: 10px;">
            <h4>{{school_name}}</h4>
            <h4>{{school_addres}}</h4>
            <h4 style="text-align: center;">TERM {{result.term}} ACADEMIC REPORT FORM-YEAR {{result.year}}</h2>
          </div>
          {% if result.student.passport %}
          <img src="{{result.student.passport.url}}" alt="Your image" class="passport-image" style="border: 1px solid black; float: left;">
          {% else %}
            <img src="{% static 'user/user.jpeg' %}" alt="Your image" class="passport-image" style="border: 2px solid black; float: left;">
            {% endif %}
        </div>
      </div>
      </div>
      <div class="card-body">
          <div class="row">
            <span class="label">NAME: {{result.student.admin.first_name}} {{result.student.admin.last_name}}</span>
            <span class="value"> </span>
            <span class="label">ADM.NO: {{result.student}}</span>
            <span class="value">  </span>
            <span class="label">FORM: {{result.student.current_class}}</span>
            <span class="value"> </span>
            <span class="label">HSE: {{result.student.current_section}}</span>
            <span class="value"> </span>
          </div>
          <div class="row">
            <span class="label">FORM POS: {{result.stream_pos}}</span>
            <span class="value"> </span>
            <span class="label">OUT OF:{{result.stream_total}} </span>
            <span class="value">  </span>
            <span class="label">CLASS POS:{{result.overall_rank}}</span>
            <span class="value">  </span>
            <span class="label">OUT OF:{{result.class_total}}</span>
            <span class="value"> </span>
            <span class="label">MEAN GRADE:{{result.mean_grade}}</span>
            <span class="value">  </span>
          </div>
          <div class="row">
            <span class="label">TOTAL MARKS:{{result.total_total}}</span>
            <span class="value">  </span>
            <span class="label">MEAN MARK:{{result.mean_total}}</span>
            <span class="value">  </span>
            <span class="label">TOTAL POINTS:{{result.total_points}}</span>
            <span class="value">  </span>
            <span class="label">MEAN POINTS:{{result.mean_points}}</span>
            <span class="value">  </span>
          </div>

      </div>
      <table class="table table-bordered">
        <thead class="thead-light">
          <tr>
            <th>SUBJECT</th>
            <th>SER 1/{{result.total_student}}</th>
            <th>SER 2/{{result.total_student}}</th>
            <th>SER 3/{{result.total_student}}</th>
            <th>TOTAL%</th>
            <th>GRADE</th>
            <th>PNTS</th>
            <th>POS.</th>
            <th>REMARKS</th>
            <th>INITIAL</th>
          </tr>
        </thead>
        <tbody>
           {% for subject in result.subjects %}
          <tr>
            <td>{{subject.subject.name}}</td>
            <td>{{subject.calculate_subject_position}}</td>
            <td>-</td>
            <td>-</td>
            <td>{{ subject.test_score|add:subject.exam_score }}</td>
            <td>{{subject.grade}}</td>
            <td>{{subject.grade.points}}</td>
            <td>{{subject.calculate_subject_position}}</td>
            <td>{{subject.grade.comment}}</td>
            <td>{{subject.subject.teachers.first}}</td>
          </tr>
          {% endfor %}
        </tbody>
      <!--</table> -->
      <table class="table table-bordered" style="min-width: 100px; max-width: 400px;margin-left: 3%;">
        <thead class="thead-light">
          <tr>
            <th colspan="20" class="text-center">Student's Progress Report</th>
          </tr>
          <tr>
            <th colspan="5" class="text-center">Form 1</th>
            <th colspan="5" class="text-center">Form 2</th>
            <th colspan="5" class="text-center">Form 3</th>
            <th colspan="5" class="text-center">Form 4</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <th>Term</th>
            <th>Pos</th>
            <th>Out Of</th>
            <th>MG</th>
            <th>MPTS</th>

            <th>Term</th>
            <th>Pos</th>
            <th>Out Of</th>
            <th>MG</th>
            <th>MPTS</th>

            <th>Term</th>
            <th>Pos</th>
            <th>Out Of</th>
            <th>MG</th>
            <th>MPTS</th>

            <th>Term</th>
            <th>Pos</th>
            <th>Out Of</th>
            <th>MG</th>
            <th>MPTS</th>
          </tr>
          <tr>
            <td>1</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>

            <td>1</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>

            <td>1</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>

            <td>1</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <td>2</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>

            <td>2</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>

            <td>2</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>

            <td>2</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <td>3</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>

            <td>3</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>

            <td>3</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>

            <td>3</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
        </tbody>
        </table>
      </table>
      </table>
      <!-- Added this -->
      <div class="chart">
        <canvas id="barChart" style="min-height: 200px; height: 200px; max-height: 200px; max-width: 50%;"></canvas>
      </div>
      <form>
        <p> <em>Head Teacher's Remarks - "Name of the head teacher"</em></p>
        <p>..................................................</p>
      </form>
      <div style="text-align: center; font-weight: bold;">
        <p>Fees arreas Kshs: "Amnt will display here" Next term fees Kshs: "Amnt will display here" Total Kshs: "Amnt will display here" Sign:_______</p>
        <p>School closed on: "date"  Next Term Begins on: "date"</p>
        <p>Parent's Sign:____________________Date_________________________</p>
      </div>
      <!-- Untill here -->
    </div>
  {% endfor %}
{% endblock content %}

{% block custom_js %}
<script>
var ctx = document.getElementById('barChart').getContext('2d');

// Define the data and labels
var data = [7, 8, 6, 10, 12];
var labels = ['F1T1','F1T2','F1T3','F2T1','F2T2','F2T3','F3T1','F3T2','F3T3','F4T1','F4T2','F4T3'];

var barChart = new Chart(ctx, {
  type: 'bar',
  data: {
    labels: labels,
    datasets: [{
      label: 'Mean Points',
      data: data,
      backgroundColor: 'black',
      borderColor: 'black',
      borderWidth: 1,
      barPercentage: 0.5
    }]
  },
  options: {
    scales: {
      y: {
        beginAtZero: true,
        max: 12,
        min: 0,
        stepSize: 2,
        title: {
          display: true,
          text: 'Mean Points',
          position: 'left'
        }
      },
      x: {
        title: {
          display: true,
          text: 'Form and Term',
          position: 'bottom'
        }
      }
    }
  }
});
</script>


{% endblock custom_js %}
